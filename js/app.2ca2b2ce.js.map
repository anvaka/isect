{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?4199","webpack:///./src/App.vue?97f3","webpack:///./src/appStatus.js","webpack:///./src/generateRandomExample.js","webpack:///./src/bus.js","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue?bff9","webpack:///./src/BBox.js","webpack:///./src/scene.js","webpack:///./src/brownian.js","webpack:///./src/generators.js","webpack:///./src/main.js","webpack:////Users/anvaka/projects/isect/src/createEventQueue.js","webpack:////Users/anvaka/projects/isect/src/geom.js","webpack:////Users/anvaka/projects/isect/src/sweepStatus.js","webpack:////Users/anvaka/projects/isect/src/SweepEvent.js","webpack:////Users/anvaka/projects/isect/sweep.js","webpack:////Users/anvaka/projects/isect/src/intersectSegments.js","webpack:////Users/anvaka/projects/isect/brute.js","webpack:////Users/anvaka/projects/isect/bush.js","webpack:////Users/anvaka/projects/isect/index.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","app","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default","Appvue_type_template_id_d501ed2a_render","_vm","this","_h","$createElement","_c","_self","attrs","id","_m","showLoading","_e","staticClass","href","on","click","$event","preventDefault","generateNew","_v","_s","linesCount","found","elapsed","staticRenderFns","appStatus","error","showMetrics","createRandom","require","prng","params","algorithm","args","min","max","qs","Math","round","gaussian","p0","v","random","p1","generateRandomExample","generatorIdx","generator","forEach","range","idx","keyName","Array","isArray","randomIndex","eventify","bus","Appvue_type_script_lang_js_","props","mounted","src_bus","fire","methods","newState","src_Appvue_type_script_lang_js_","component","componentNormalizer","options","__file","App","BBox","classCallCheck","minX","Number","POSITIVE_INFINITY","minY","maxX","NEGATIVE_INFINITY","maxY","offset","xIn","yIn","undefined","Error","x","y","rect","addPoint","left","top","right","bottom","otherBBox","createScene","isect","wgl","canvas","lines","isAsync","algorithmName","scene","setClearColor","bounds","line","from","to","pixelRatio","getPixelRatio","setViewBox","width","height","iSector","nodeCollection","linesEl","WireCollection","color","g","b","a","add","appendChild","nextFrame","status","totalElapsed","startTheDemoHandle","setTimeout","startTheDemo","dispose","runAsync","runSync","startTime","performance","now","onError","intersections","run","e","console","brute","log","updateSearchMetrics","drawIntersections","err","drawSweepStatus","sweepStatus","results","start","end","requestAnimationFrame","frame","next","hasMore","step","printStatus","formatWithDecimalSeparator","cancelAnimationFrame","clearTimeout","stepsPerFrame","pt","getLastPoint","point","removeChild","PointCollection","ui","setColor","segments","keys","intersect","toString","replace","seed","Date","splash","minMax","alpha","PI","points","getArr","cos","sin","island","pointsCount","bands","sqrt","da","angle","nextDouble","tMin","tMax","arguments","arr","dx","dy","variance","newArr","prev","mid","interpolate","count","parallelSlanted","sparse","size","rows","columns","triangle","idxVar","idxToUse","drawTriangle","cp","rotate","middle","concat","center","cube","forwardAngle","dAngle","addRect","grid","vertical","horizontal","drunkgrid","complete","angleStep","seen","Set","ex","ey","sKey","getKey","has","whitelistedAlgorithms","queryState","useSearch","onChange","updateScene","renderFirstTime","set","currentScene","sceneOptions","getSceneOptions","document","getElementById","appState","state","gen","getNumber","defaultValue","num","parseFloat","isFinite","Vue","config","productionTip","render","h","$mount","createEventQueue","byY","q","SplayTree","isEmpty","pop","find","insert","event","node","EPS","getIntersectionXPoint","segment","xPos","yPos","dy1","dy2","abs","xOffset","intersectSegments","aStart","bStart","p0_x","p0_y","p2_x","p2_y","s1_x","s1_y","s2_x","s2_y","div","samePoint","createSweepStatus","lastPointY","prevY","lastPointX","prevX","useBelow","compareSegments","currentBoundary","beforeLeft","afterRight","currentLeftRight","insertSegments","deleteSegments","getLeftRightPoint","getBoundarySegments","findSegmentsWithPoint","checkDuplicate","ak","bk","res","aIsHorizontal","bIsHorizontal","pa","pb","segDist","upper","interior","leftMost","rightMost","uLength","cmp","startFrom","lastLeft","current","_root","onFound","collectAdjacentNodes","root","goOverPredecessors","goOverSuccessors","prefix","sweepLinePos","lower","prevCount","_size","removeSegment","remove","SweepEvent","EMPTY","lastPoint","reportIntersection","defaultIntersectionReporter","defaultErrorReporter","eventQueue","addSegment","eventPoint","handleEventPoint","addLowerOrInterior","sLeft","sRight","iLength","lLength","hasIntersection","hasPointIntersection","isReported","union","hasNoCrossing","leftRight","findNewEvent","boundarySegments","intersection","roundNearZero","temp","isPoint","prevFrom","errorMessage","asyncState","test","other","bush","index","Flatbush","addToIndex","finish","checkIntersection","currentSegment","currentId","ids","search","segmentIndex","otherSegment","__webpack_exports__"],"mappings":"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","file":"js/app.2ca2b2ce.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/lib/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/lib/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_vm._m(0),(!_vm.showLoading)?_c('div',[_c('a',{staticClass:\"action\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();_vm.generateNew()}}},[_vm._v(\"Generate New Demo\")])]):_vm._e(),(_vm.showMetrics)?_c('div',{staticClass:\"results\"},[_c('div',[_c('strong',[_vm._v(_vm._s(_vm.linesCount))]),_vm._v(\" lines. Found \"),_c('strong',[_vm._v(_vm._s(_vm.found))]),_vm._v(\" intersections in \"),_c('strong',[_vm._v(_vm._s(_vm.elapsed))])])]):_vm._e(),(_vm.showLoading)?_c('div',{staticClass:\"loading-container\"},[_c('div',{staticClass:\"loader\"},[_vm._v(\"Finding intersections...\")]),_c('div',{staticClass:\"label\"},[_vm._v(\"Finding intersections...\")])]):_vm._e(),(_vm.error)?_c('div',{staticClass:\"error\"},[_vm._v(\"\\n    Asserting failed in sweep line.\\n  \")]):_vm._e(),_c('a',{staticClass:\"info\",attrs:{\"href\":\"https://github.com/anvaka/isect\"}},[_vm._v(\"Source code\")])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('h3',[_c('strong',[_vm._v(\"isect\")]),_vm._v(\" - intersection detection library\")])}]\n\nexport { render, staticRenderFns }","export default {\n  error: null,\n  showMetrics: false,\n  showLoading: false,\n  elapsed: 0,\n  found: 0,\n  linesCount: 0,\n}","var createRandom = require('ngraph.random');\nvar prng = createRandom(42);\n\nvar params = [\n  {\n    name: 'random',\n    algorithm: ['brute', 'bush'],\n    args: [\n      {min: 100, max: 500},  // number of lines\n      {min: 100, max: 200},  // visible area\n    ]\n  },\n  {\n    name: 'complete',\n    algorithm: ['brute', 'bush'],\n    args: [\n      {min: 10, max: 40},  // number of nodes\n      function p1(qs) {\n        return Math.round((10 + prng.gaussian()) * qs.p0);\n        // {min: 400, max: 600},  // visible area\n      }\n    ]\n  },\n  {\n    name: 'cube',\n    algorithm: ['brute', 'bush'],\n    args: [\n      {min: 100, max: 150},  // number of rects\n      function p2() {\n        return Math.round((10 + prng.gaussian()));\n      }\n    ]\n  },\n  {\n    name: 'drunkgrid',\n    algorithm: ['brute', 'bush'],\n    args: [\n      {min: 10, max: 150},  // Row x Col\n      function p2(qs) {\n        var v = Math.round(Math.random() * 10) + 1;\n        if (v === 0) return 0;\n        if (qs.p0 > 20 && v < 1) v = 3;\n        return v;\n      }\n    ]\n  },\n  {\n    name: 'sparse',\n    algorithm: ['bush', 'bush', 'sweep'],\n    args: [\n      {min: 50, max: 300},  // Count  \n    ]\n  },\n  {\n    name: 'triangle',\n    algorithm(qs) {\n      // sparse is better with sweep\n      return (qs.p1 > 7) ? 'brute' : 'bush'\n    },\n    args: [\n      {min: 10, max: 30},  // Count  \n      {min: 1, max: 20},  // Count  \n    ]\n  },\n  {\n    name: 'splash',\n    algorithm: ['sweep', 'bush'],\n    args: [\n      {min: 10, max: 50},  // Number of lines  \n      {min: 40, max: 70},  // squared variance  \n    ]\n  },\n  {\n    name: 'island',\n    algorithm: ['sweep', 'bush'],\n    args: [\n      {min: 3, max: 10},  // Number of control points on circle\n      {min: 6, max: 11},  // Number of subdivisions\n    ]\n  }\n]\n\nexport default function generateRandomExample() {\n  var generatorIdx = Math.round(Math.random() * (params.length - 1));\n  var generator = params[generatorIdx];\n\n  var qs = {\n    generator: generator.name\n  }\n  generator.args.forEach((range, idx) => {\n    var keyName = `p${idx}`;\n    if (typeof range === 'function') {\n      qs[keyName] = range(qs);\n    } else  {\n      qs[keyName] = Math.round(Math.random() * (range.max - range.min) + range.min);\n    }\n  });\n  var algorithm = 'sweep';\n  if (Array.isArray(generator.algorithm)) {\n    var randomIndex = Math.round(Math.random() * (generator.algorithm.length - 1));\n    algorithm = generator.algorithm[randomIndex];\n  } else if (typeof generator.algorithm === 'function') {\n    algorithm = generator.algorithm(qs);\n  } else if (typeof generator.algorithm === 'string') {\n    algorithm = generator.algorithm;\n  }\n  qs.algorithm = algorithm;\n\n  return qs;\n}","var eventify = require('ngraph.events');\nconst bus = eventify({});\n\nexport default bus;","<template>\n  <div id=\"app\">\n    <h3><strong>isect</strong> - intersection detection library</h3>\n    <div v-if='!showLoading'>\n      <a href='#' @click.prevent='generateNew()' class='action'>Generate New Demo</a>\n    </div>\n    <div v-if='showMetrics' class='results'>\n      <div><strong>{{linesCount}}</strong> lines. Found <strong>{{found}}</strong> intersections in <strong>{{elapsed}}</strong></div>\n    </div>\n    <div v-if='showLoading' class='loading-container'>\n      <div class='loader'>Finding intersections...</div>\n      <div class='label'>Finding intersections...</div>\n    </div>\n    <div class='error' v-if='error'>\n      Asserting failed in sweep line.\n    </div>\n    <a href='https://github.com/anvaka/isect' class='info'>Source code</a>\n  </div>\n</template>\n\n<script>\nimport appState from './appStatus.js';\nimport generateRandomExample from './generateRandomExample';\nimport bus from './bus';\n\nexport default {\n  name: 'app',\n  props: ['state'],\n  data() {\n    return appState;\n  },\n  mounted() {\n    bus.fire('app-loaded');\n  },\n  methods: {\n    generateNew() {\n      this.showLoading = true;\n      this.showMetrics = false;\n      var newState = generateRandomExample();\n      bus.fire('change-qs', newState);\n    }\n  },\n}\n</script>\n\n<style>\n#app {\n  width: 400px;\n  position: absolute;\n  padding: 8px;\n  background: #101830;\n}\na.action {\n  color: #fff;\n  font-size: 16px;\n  padding: 8px;\n  flex: 1;\n  border: 1px solid #99c5f1;\n  justify-content: center;\n  align-items: center;\n  display: flex;\n}\nh3 {\n  margin: 7px 0;\n  font-weight: normal;\n}\nh3 strong {\n  font-weight: bold;\n}\na {\n  text-decoration: none;\n}\n.results {\n  margin-top: 7px;\n}\n.error {\n  background: orangered;\n  margin: 0 -8px;\n  padding: 0 8px;\n}\n\n.info {\n  position: fixed;\n  right: 8px;\n  top: 8px;\n  color: white;\n  border-bottom: 1px dashed;\n}\n\n@media (max-width: 600px) {\n  #app {\n    width: 100%;\n    margin: 0px;\n    padding: 0px;\n  }\n  .results {\n    font-size: 12px;\n    margin: 7px;\n  }\n  h3 {\n    margin: 7px;\n  }\n  .error {\n    padding: 0 7px;\n    margin: 0;\n  }\n\n  .info {\n    bottom: 42px;\n    left: 8px;\n    right: inherit;\n    top: inherit;\n  }\n}\n.loading-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 38px;\n  border: 1px solid #777;\n}\n\n.loading-container .label {\n  margin-left: 8px;\n}\n\n.loader,\n.loader:before,\n.loader:after {\n  border-radius: 50%;\n}\n.loader {\n  color: #ffffff;\n  font-size: 2px;\n  text-indent: -99999em;\n  position: relative;\n  width: 10em;\n  height: 10em;\n  box-shadow: inset 0 0 0 1em;\n  -webkit-transform: translateZ(0);\n  -ms-transform: translateZ(0);\n  transform: translateZ(0);\n}\n.loader:before,\n.loader:after {\n  position: absolute;\n  content: '';\n}\n.loader:before {\n  width: 5.2em;\n  height: 10.2em;\n  background: #101830;\n  border-radius: 10.2em 0 0 10.2em;\n  top: -0.1em;\n  left: -0.1em;\n  -webkit-transform-origin: 5.2em 5.1em;\n  transform-origin: 5.2em 5.1em;\n  -webkit-animation: load2 2s infinite ease 1.5s;\n  animation: load2 2s infinite ease 1.5s;\n}\n.loader:after {\n  width: 5.2em;\n  height: 10.2em;\n  background: #101830;\n  border-radius: 0 10.2em 10.2em 0;\n  top: -0.1em;\n  left: 5.1em;\n  -webkit-transform-origin: 0px 5.1em;\n  transform-origin: 0px 5.1em;\n  -webkit-animation: load2 2s infinite ease;\n  animation: load2 2s infinite ease;\n}\n@-webkit-keyframes load2 {\n  0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n@keyframes load2 {\n  0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=d501ed2a&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"App.vue\"\nexport default component.exports","export default class BBox {\n  constructor() {\n    this.minX = Number.POSITIVE_INFINITY;\n    this.minY = Number.POSITIVE_INFINITY;\n    this.maxX = Number.NEGATIVE_INFINITY;\n    this.maxY = Number.NEGATIVE_INFINITY;\n  }\n\n  growBy(offset) {\n    this.minX -= offset;\n    this.minY -= offset;\n    this.maxX += offset;\n    this.maxY += offset;\n  }\n\n  get left() {\n    return this.minX;\n  }\n\n  get top() {\n    return this.minY;\n  }\n\n  get right() {\n    return this.maxX;\n  }\n\n  get bottom() {\n    return this.maxY;\n  }\n\n  get width() {\n    return this.maxX - this.minX;\n  }\n\n  get height() {\n    return this.maxY - this.minY;\n  }\n\n  get cx() {\n    return (this.minX + this.maxX)/2;\n  }\n\n  get cy() {\n    return (this.minY + this.maxY)/2;\n  }\n\n  addPoint(xIn, yIn) {\n    if (xIn === undefined) throw new Error('Point is not defined');\n    let x = xIn;\n    let y = yIn;\n    if (y === undefined) {\n      // xIn is a point object\n      x = xIn.x;\n      y = xIn.y;\n    }\n\n    if (x < this.minX) this.minX = x;\n    if (x > this.maxX) this.maxX = x;\n    if (y < this.minY) this.minY = y;\n    if (y > this.maxY) this.maxY = y;\n  }\n\n  addRect(rect) {\n    if (!rect) throw new Error('rect is not defined');\n    this.addPoint(rect.left, rect.top);\n    this.addPoint(rect.right, rect.top);\n    this.addPoint(rect.left, rect.bottom);\n    this.addPoint(rect.right, rect.bottom);\n  }\n\n  merge(otherBBox) {\n    if (otherBBox.minX < this.minX) this.minX = otherBBox.minX;\n    if (otherBBox.minY < this.minY) this.minY = otherBBox.minY;\n    if (otherBBox.maxX > this.maxX) this.maxX = otherBBox.maxX;\n    if (otherBBox.maxY > this.maxY) this.maxY = otherBBox.maxY;\n  }\n}","import BBox from './BBox';\nimport appStatus from './appStatus';\n\nexport default createScene;\n\nlet isect = require('../../../index.js');\nlet wgl = require('w-gl');\n\nfunction createScene(options, canvas) {\n  var lines = options.lines;\n  var isAsync = options.isAsync;\n  var algorithmName = options.algorithm;\n  var scene = wgl.scene(canvas);\n  scene.setClearColor( 0x0C/255, 0x18/255, 0x34/255, 1);\n  var bounds = new BBox();\n  lines.forEach(line => {\n    bounds.addPoint(line.from);\n    bounds.addPoint(line.to);\n  });\n\n  var pixelRatio = scene.getPixelRatio();\n  var left = bounds.left / pixelRatio;\n  var top = bounds.top / pixelRatio;\n  scene.setViewBox({\n    left, top,\n    right:  left + bounds.width / pixelRatio,\n    bottom: top + bounds.height / pixelRatio\n  })\n\n  // var guidelines = new wgl.WireCollection(lines.length);\n  // guidelines.color = {r: 0.1, g: 0.4, b: 0.8, a: 0.9};\n\n  // ([\n  //   {from: {x: -100, y: 0}, to: {x: 100, y: 0}},\n  //   {from: {x: 0, y: -100}, to: {x: 0, y: 100}},\n  // ]).forEach(function (line) {\n  //   guidelines.add({ from: line.from, to: line.to });\n  // });\n\n  // scene.appendChild(guidelines);\n\n  var linesEl = new wgl.WireCollection(lines.length);\n  linesEl.color.r = 0xee/255;\n  linesEl.color.g = 0xee/255;\n  linesEl.color.b = 0xee/255;\n  linesEl.color.a = 0.9;\n  lines.forEach(function (line) {\n    linesEl.add({ from: line.from, to: line.to });\n  });\n\n  scene.appendChild(linesEl);\n\n  var iSector, nodeCollection;\n  var status = {};\n  var nextFrame;\n\n  var totalElapsed = 0;\n  appStatus.showMetrics = false;\n  appStatus.showLoading = true;\n  // Need to start a bit later, so that vue catches up with UI updates\n  var startTheDemoHandle = setTimeout(startTheDemo, 80);\n\n  return {\n    dispose\n  }\n\n  function startTheDemo() {\n    appStatus.error = null;\n    if (isAsync) {\n      runAsync();\n    } else {\n      runSync();\n    }\n    appStatus.showLoading = false;\n    appStatus.showMetrics = true;\n  }\n\n  function runSync() {\n    // eslint-disable-next-line\n    var startTime = window.performance.now();\n    iSector = isect[algorithmName](lines, { onError });\n    try {\n      var intersections = iSector.run();\n    } catch (e) {\n      // Error is reported in the onError.\n      // eslint-disable-next-line\n      console.error(e);\n      // fall back to brute force.\n      intersections = isect.brute(lines).run();\n    }\n    var elapsed = window.performance.now() - startTime;\n    // eslint-disable-next-line\n    console.log('finished in ' + elapsed + 'ms')\n    if (intersections) {\n      // eslint-disable-next-line\n      console.log('found ' + intersections.length + ' intersections');\n      updateSearchMetrics(elapsed);\n      drawIntersections(intersections)\n    }\n  }\n\n  function onError(err) {\n    appStatus.error = 'Rounding error detected';\n    drawSweepStatus(iSector.sweepStatus);\n    drawIntersections(iSector.results);\n    throw new Error(err);\n  }\n\n  function runAsync() {\n    var start = performance.now();\n    // only sweep line supports async running at the moment\n    iSector = isect[algorithmName](lines, { onError });\n    var end = performance.now();\n    totalElapsed += (end - start);\n    updateSearchMetrics(totalElapsed);\n\n    nextFrame = requestAnimationFrame(frame);\n\n    // for console driven debugging\n    window.next = () => {\n      var hasMore = iSector.step();\n      if (iSector.sweepStatus) {\n        drawSweepStatus(iSector.sweepStatus);\n        iSector.sweepStatus.printStatus();\n      }\n      drawIntersections(iSector.results)\n      return hasMore;\n    }\n  }\n\n  function updateSearchMetrics(elapsed) {\n    appStatus.found = formatWithDecimalSeparator(iSector.results.length);\n    appStatus.elapsed = (Math.round(elapsed * 100)/100) + 'ms';\n    appStatus.linesCount = formatWithDecimalSeparator(lines.length);\n  }\n\n  function dispose() {\n    if (nextFrame) {\n      cancelAnimationFrame(nextFrame);\n      nextFrame = 0;\n    }\n    scene.dispose();\n    clearTimeout(startTheDemoHandle);\n    startTheDemoHandle = 0;\n  }\n\n  function frame() {\n    var hasMore;\n    var start = performance.now();\n    for (var i = 0; i < options.stepsPerFrame; ++i) {\n      hasMore = iSector.step();\n    }\n    var end = performance.now();\n    totalElapsed += end - start;\n    updateSearchMetrics(totalElapsed);\n\n    drawSweepStatus(iSector.sweepStatus);\n    drawIntersections(iSector.results)\n\n    if (hasMore) {\n      nextFrame = requestAnimationFrame(frame);\n    } else {\n      nextFrame = null;\n    }\n  }\n\n  function drawSweepStatus(sweepStatus) {\n    if (!sweepStatus) return;\n\n    var pt = sweepStatus.getLastPoint();\n    if (status.point) {\n      scene.removeChild(status.point);\n    }\n\n    status.point = new wgl.PointCollection(1);\n    var ui = status.point.add(pt);\n    ui.setColor({r: 1, g: 0, b: 0});\n    scene.appendChild(status.point);\n\n    // status line\n    if (status.line) {\n      scene.removeChild(status.line);\n    }\n    status.line = new wgl.WireCollection(1);\n    status.line.color = {r: 0.1, g: 1.0, b: 1.0, a: 0.9};\n    status.line.add({ from: {\n      x: -1000, y: pt.y\n    }, to: {x: 1000, y: pt.y} });\n    scene.appendChild(status.line);\n\n    // lines\n    if (status.segments) {\n      scene.removeChild(status.segments);\n    }\n    var segments = sweepStatus.status.keys();\n    status.segments = new wgl.WireCollection(segments.length);\n    status.segments.color = {r: 0.1, g: 1.0, b: 0.0, a: 0.9};\n    segments.forEach(s => {\n      status.segments.add({ from: s.from, to: s.to });\n    })\n\n    scene.appendChild(status.segments);\n  }\n\n  function drawIntersections(intersections) {\n    if (nodeCollection) {\n      scene.removeChild(nodeCollection)\n      nodeCollection = null;\n    }\n    if (intersections.length > 0) {\n      nodeCollection = new wgl.PointCollection(intersections.length);\n      intersections.forEach((intersect, id) => {\n        var ui = nodeCollection.add(intersect.point, id);\n        ui.setColor({r: 0xA3/244, g: 0x255/255, b: 0x255/255})\n      })\n      scene.appendChild(nodeCollection);\n    }\n  }\n}\n\nfunction formatWithDecimalSeparator(x) {\n  return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\n","var createRandom = require('ngraph.random');\nvar seed = +new Date();\nvar prng = createRandom(seed);\n\nexport function splash(linesCount, minMax) {\n  var lines = [];\n  for (var j = 0; j < linesCount; ++j) {\n    var r = prng.gaussian() * minMax;\n    var alpha = prng.gaussian() * Math.PI * 2;\n    var points = getArr({\n      x: prng.gaussian(),\n      y: prng.gaussian() \n    }, {\n      x: r * Math.cos(alpha), \n      y: r * Math.sin(alpha)\n    }, 7);\n\n    for (var i = 1; i < points.length; ++i) {\n      lines.push({\n        from: points[i - 1],\n        to: points[i]\n      })\n    }\n  }\n  return lines;\n}\n\nexport function island(pointsCount, bands) {\n  var r = 100 * Math.sqrt(bands);\n  var da = 2 * Math.PI/pointsCount;\n  var angle = prng.gaussian();\n  var lines = [];\n  var end = {\n    x: r * Math.cos(angle),\n    y: r * Math.sin(angle)\n  };\n  var from = end;\n\n  for (var j = 0; j < pointsCount; ++j) {\n    r = prng.nextDouble() * 100;\n    angle += da;\n    var to = j < pointsCount - 1 ? {\n      x: r * Math.cos(angle),\n      y: r * Math.sin(angle)\n    } : end; // close the loop.\n    var points = getArr(from, to, bands);\n    for (var i = 1; i < points.length; ++i) {\n      lines.push({\n        from: points[i - 1],\n        to:   points[i]\n      })\n    }\n    from = to;\n  }\n\n  return lines;\n}\n\nfunction getArr(tMin, tMax, bands = 8) {\n  var arr = [tMin, tMax];\n  var dx = tMax.x - tMin.x;\n  var dy = tMax.y - tMin.y;\n  var l = Math.sqrt(dx * dx + dy * dy);\n  var variance = l;\n\n  for (var j = 0; j < bands; ++j) {\n    var newArr = [];\n    // fill in intermediate entries\n    for (var i = 1; i < arr.length; i += 1) {\n      var prev = arr[i - 1];\n\n      var mid = interpolate(prev, arr[i], Math.sqrt(variance));\n      newArr.push(prev, mid);\n    }\n    newArr.push(arr[arr.length - 1]);\n    variance /= 2;\n    arr = newArr;\n  }\n  return arr;\n}\n\nfunction interpolate(p0, p1, variance) {\n  return {\n    x: (p0.x + p1.x) * 0.5 + prng.gaussian() * variance,\n    y: (p0.y + p1.y) * 0.5 + prng.gaussian() * variance,\n  }\n}","/** TODO: How do I remove duplicates from here and perf? */\nvar createRandom = require('ngraph.random');\nvar seed = +new Date();\nvar prng = createRandom(seed);\n\nexport * from './brownian';\n\nexport function random(count = 4, range = 100, seed) {\n  seed = 1536687392180\n  if (seed !== undefined) {\n    prng = createRandom(seed);\n  }\n  var lines = [];\n  for (var i = 0; i < count; ++i) {\n    lines.push({\n      from: {x: (prng.nextDouble() - 0.5) * range, y: (prng.nextDouble() - 0.5) * range},\n      to: {x: (prng.nextDouble() - 0.5) * range, y: (prng.nextDouble() - 0.5) * range}\n    });\n  }\n  return lines;\n}\n\nexport function parallelSlanted(count) {\n  var lines = [];\n  for (var i = 0; i < count; ++i) {\n    var x = -i, y = i;\n    lines.push({\n      from: {x, y},\n      to: {x: i, y: i + i}\n    })\n  }\n  return lines;\n}\n\nexport function sparse(size = 50) {\n  var lines = [];\n  var rows = size, columns = size;\n  for (var j = 0; j < rows; ++j) {\n    for (var i = 0; i < columns; ++i) {\n      var x = i * 10, y = j * 10;\n      var a = prng.gaussian();\n\n      lines.push({\n        from: {x, y},\n        to: {x: x + 10 * Math.cos(a), y: y + 10 * Math.sin(a)}\n      });\n    }\n  }\n  return lines;\n}\n\nexport function triangle(count = 4, variance = 10) {\n  // return [\n  //   { from: { x: 0, y: 2 }, to: { x: 0, y: 2 }, name: \"B0,2\"},\n  //   { from: { x: -4, y: 0}, to: { x: 2, y: 0 }, name: \"B2,0\"},\n  //   { from: { x: -1, y: 6}, to: { x: 2, y: 0 }, name: \"D2,0\"},\n  //   { from: { x: 2, y: 2 }, to: { x: 4, y: -3}, name: \"D2,2\"}\n  // ]\n  // return [\n  //   {from: {x: 0, y: 0}, to: {x: 10, y: 10 }, name: 'segment'},\n  //   {from: {x: 5, y: 5}, to: {x: 5, y: 5 }, name: 'point'},\n  // ]\n  // return [\n  //   {from: {x: 0, y: 0}, to: {x: 10, y:   10 }, name: '0-10'},\n  //   {from: {x: 5, y: 5}, to: {x: 15, y:   15 }, name: '5-15'},\n  // ]\n  // return [\n  //   {from: {x: 0, y: 0}, to: {x: 10, y:   0 }, name: 'B0,0'},\n  //   {from: {x: 1, y: 0}, to: {x: 11, y:   0 }, name: 'B1,0'},\n  //   {from: {x: 2, y: 0}, to: {x:  7, y: -10 }, name: 'D2,0'}\n  // ]\n  var lines = [];\n  var step = 5;\n  var idxVar = prng.nextDouble() < 0.5 ? 1 : 0;\n  for (var i = 0; i < count; ++i) {\n    for (var j = 0; j < count; ++j) {\n      var x = step * i;\n      var y = step * j;\n\n      var idxToUse = (i % 2 === idxVar) ? i : j;\n      var angle =  Math.PI * (idxToUse/count - prng.gaussian());\n      drawTriangle(x, y, variance, angle);\n    }\n  }\n\n  return lines;\n\n  function drawTriangle(x, y, width, alpha) {\n    var cp = {x: x + width/2, y: y - width/2};\n    var left = rotate({x: x, y: y}, cp, alpha);\n    var right = rotate({x: x + width, y: y}, cp, alpha);\n    var middle = rotate({x: x + width/2, y: y - width}, cp, alpha);\n\n    lines.push(\n      {from: {x: left.x, y: left.y}, to: {x: right.x, y: right.y}, name: `B${x},${y}`},\n      {from: {x: right.x, y: right.y}, to: {x: middle.x, y: middle.y}, name: `U${x},${y}`},\n      {from: {x: middle.x, y: middle.y}, to: {x: left.x, y: left.y}, name: `D${x},${y}`}\n    )\n  }\n}\n\nfunction rotate(point, center, alpha) {\n  point.x -= center.x;\n  point.y -= center.y;\n\n  var x = Math.cos(alpha) * point.x - point.y * Math.sin(alpha) + center.x;\n  var y = Math.sin(alpha) * point.x + point.y * Math.cos(alpha) + center.y;\n  return {x, y};\n}\n\nexport function cube(count = 4, variance = 10) {\n  var forwardAngle = 0;\n  var r = 4;\n  var dAngle = Math.PI/count;\n\n  var lines = [];\n  for (var i = 0; i < count; ++i) {\n    forwardAngle += dAngle + prng.gaussian() * variance;\n    addRect(forwardAngle, r);\n    r += prng.gaussian() * variance;\n  }\n  return lines;\n\n  function addRect(angle, r) {\n    var x = Math.cos(angle) * r;\n    var y = Math.sin(angle) * r;\n\n    lines.push({\n        from: {x: x, y: y},\n        to: {x: -y, y: x},\n      },\n      {\n        from: {x: -y, y: x},\n        to: {x: -x, y: -y}\n      },\n      {\n        from: {x: -x, y: -y},\n        to: {x: y, y: -x}\n      },\n      {\n        from: {x: y, y: -x},\n        to: {x: x, y: y}\n      }\n    );\n  }\n}\n\nexport function grid(vertical = 10, horizontal = 10) {\n  var lines = [];\n  var dx = 0; var dy = -0.3;\n  for (var i = 0; i < vertical; i += 1) {\n    lines.push({\n      name: 'h' + i,\n      from: {x: dx, y: i + dy},\n      to: {x: dx + (horizontal - 1), y: i + dy}\n    });\n  }\n\n  for (i = 0; i < horizontal; i += 1) {\n    lines.push({\n      name: 'v' + i,\n      from: {x: dx + i, y: dy},\n      to: {x: dx + i, y: (vertical - 1) + dy}\n    });\n  }\n  return lines;\n}\n\nexport function drunkgrid(size = 10, variance = 10) {\n  // return [{\n  //   from: {x: 0, y: 0},\n  //   to: {x: 10, y: 10},\n  // }, {\n  //   from: {x: 5, y: 5},\n  //   to: {x: 20, y: 20},\n  // }]\n  // This setup is very bad..\n  // return [\n  //   {\n  //     \"name\": \"v2\",\n  //     \"from\": {\n  //       \"x\": -0.9065090071796865,\n  //       \"y\": 15.263401779954687\n  //     },\n  //     \"to\": {\n  //       \"x\": 14.340720330320922,\n  //       \"y\": -2.8453003847556446\n  //     },\n  //     \"dy\": 18.108702164710333,\n  //     \"dx\": -15.247229337500608,\n  //     \"angle\": -0.4571069866986017\n  //   },\n  //   {\n  //     \"name\": \"v0\",\n  //     \"from\": {\n  //       \"x\": 7.0121826553229045,\n  //       \"y\": 6.51578380772819\n  //     },\n  //     \"to\": {\n  //       \"x\": -14.33942114543839,\n  //       \"y\": 6.5156799042713605\n  //     },\n  //     \"dy\": 0.00010390345682953495,\n  //     \"dx\": 21.351603800761296,\n  //     \"angle\": 0.9999951337167842\n  //   },\n  //   {\n  //     \"name\": \"v1\",\n  //     \"from\": {\n  //       \"x\": -7.166517787738302,\n  //       \"y\": 10.160876487964895\n  //     },\n  //     \"to\": {\n  //       \"x\": 9.088398499652495,\n  //       \"y\": -15.20648970096957\n  //     },\n  //     \"dy\": 25.367366188934465,\n  //     \"dx\": -16.2549162873908,\n  //     \"angle\": -0.3905339957422227\n  //   },\n  // ]\n  var lines = [];\n  var dx = -2 * variance; var dy = -2 * variance;\n  for (var i = 0; i < size; i += 1) {\n    lines.push({\n      name: 'h' + i,\n      from: {x: dx + prng.gaussian() * variance, y: i + dy + prng.gaussian() * variance},\n      to: {x: dx + (size - 1) + prng.gaussian() * variance, y: i + dy + prng.gaussian() * variance}\n    });\n    lines.push({\n      name: 'v' + i,\n      from: {x: dx + i + prng.gaussian() * variance, y: dy + prng.gaussian() * variance},\n      to: {x: dx + i + prng.gaussian() * variance, y: (size - 1) + dy + prng.gaussian() * variance}\n    });\n  }\n\n  return lines;\n}\n\nexport function complete(count = 10, range = 100) {\n  var angleStep = 2 * Math.PI / count;\n  var lines = [];\n  var seen = new Set();\n\n  for (var i = 0; i < count; ++i) {\n    var angle = angleStep * i;\n    var x = Math.cos(angle) * range / 2;\n    var y = Math.sin(angle) * range / 2;\n    for (var j = 0; j < count; ++j) {\n      if (j !== i) {\n        var ex = Math.cos(angleStep * j) * range / 2;\n        var ey = Math.sin(angleStep * j) * range / 2;\n        var name = `${i},${j}`;\n        var l = {\n          name: name,\n          from: {x: x, y: y},\n          to: {x: ex, y: ey}\n        };\n        var sKey = getKey(i, j);\n        if (!seen.has(sKey)) {\n          lines.push(l);\n          seen.add(sKey)\n        }\n      }\n    }\n  }\n\n  return lines;\n\n  function getKey(i, j) {\n    return i < j ? i + ';' + j : j + ';' + i;\n  }\n}\n","import Vue from 'vue'\nimport App from './App.vue'\nimport createScene from './scene';\n\nimport * as gen from './generators';\nimport queryState from 'query-state';\n\nimport bus from './bus';\n\nvar whitelistedAlgorithms = new Set(['brute', 'bush', 'sweep']);\n\nvar qs = queryState({\n  isAsync: false,\n  p0: 150,\n  p1: 4,\n  generator: 'drunkgrid',\n  algorithm: 'brute',\n}, {\n  useSearch: true\n});\n\nqs.onChange(updateScene);\nbus.on('app-loaded', renderFirstTime);\nbus.on('change-qs', (newState) => {\n  qs.set(newState);\n  updateScene(newState);\n})\n\nvar sceneOptions = getSceneOptions(qs.get());\nvar currentScene;\n\nVue.config.productionTip = false\n\nnew Vue({\n  render: h => h(App)\n}).$mount('#app')\n\n\nfunction renderFirstTime() {\n  currentScene = createScene(sceneOptions, document.getElementById('scene'));\n}\n\nfunction updateScene(appState) {\n  appState.showLoading = true;\n  appState.showMetrics = false;\n  sceneOptions = getSceneOptions(appState);\n  if (currentScene) {\n    currentScene.dispose();\n  }\n  currentScene = createScene(sceneOptions, document.getElementById('scene'));\n}\n\nfunction getSceneOptions(state) {\n  var generator = state.generator;\n  if (!(generator in gen)) {\n    generator = 'drunkgrid'\n  }\n  var p0 = getNumber(state.p0, 50); \n  var p1 = getNumber(state.p1, 4);\n\n  var lines = gen[generator](p0, p1);\n  window.lines = lines;\n  var isAsync = state.isAsync;\n  var stepsPerFrame = getNumber(state.stepsPerFrame, 20);\n  return {\n    lines, \n    isAsync, \n    stepsPerFrame,\n    algorithm: whitelistedAlgorithms.has(state.algorithm) ? state.algorithm : 'bush'\n  }\n}\n\nfunction getNumber(x, defaultValue) {\n  var num = Number.parseFloat(x);\n  return Number.isFinite(num) ? num : defaultValue;\n}","import SplayTree from 'splaytree';\n\nexport default function createEventQueue(byY) {\n  const q = new SplayTree(byY);\n\n  return {\n    isEmpty: isEmpty,\n    size: size,\n    pop: pop,\n    find: find,\n    insert: insert\n  }\n\n  function find(p) {\n    return q.find(p);\n  }\n\n  function size() {\n    return q.size;\n  }\n\n  function isEmpty() {\n    return q.isEmpty();\n  }\n\n  function insert(event) {\n    // debugger;\n    q.add(event.point, event);\n  }\n\n  function pop() {\n    var node = q.pop();\n    return node && node.data;\n  }\n}\n","/**\n * Just a collection of geometry related utilities\n */\n\n// This is used for precision checking (e.g. two numbers are equal\n// if their difference is smaller than this number). The value is \n// chosen empirically. We still may run into precision related issues.\n// TODO: we should allow consumers to configure this.\nexport const EPS = 1e-9;//10;\n\nexport function getIntersectionXPoint(segment, xPos, yPos) {\n  var dy1 = segment.from.y - yPos;\n  var dy2 = yPos - segment.to.y;\n  var dy = segment.to.y - segment.from.y;\n  if (Math.abs(dy1) < EPS) {\n    // The segment starts on the sweep line\n    if (Math.abs(dy) < EPS) {\n      // the segment is horizontal. Intersection is at the point\n      if (xPos <= segment.from.x) return segment.from.x;\n      if (xPos > segment.to.x) return segment.to.x;\n      return xPos;\n    }\n    return segment.from.x;\n  }\n  \n  var dx = (segment.to.x - segment.from.x); \n  var xOffset; \n  if (dy1 >= dy2) {\n    xOffset = dy1 * (dx / dy); \n    return (segment.from.x - xOffset);\n  } \n  xOffset = dy2 * (dx / dy);\n  return (segment.to.x + xOffset);\n}\n\nexport function angle(dx, dy) {\n  // https://stackoverflow.com/questions/16542042/fastest-way-to-sort-vectors-by-angle-without-actually-computing-that-angle\n  var p = dx/(Math.abs(dx) + Math.abs(dy)) // -1 .. 1 increasing with x\n\n  if (dy < 0) return p - 1;  // -2 .. 0 increasing with x\n  return 1 - p               //  0 .. 2 decreasing with x\n}\n\nexport function intersectSegments(a, b) {\n  //  https://stackoverflow.com/a/1968345/125351\n  var aStart = a.from, bStart = b.from;\n  var p0_x = aStart.x, p0_y = aStart.y,\n      p2_x = bStart.x, p2_y = bStart.y;\n\n  var s1_x = a.dx, s1_y = a.dy, s2_x = b.dx, s2_y = b.dy;\n  var div = s1_x * s2_y - s2_x * s1_y;\n\n  var s = (s1_y * (p0_x - p2_x) - s1_x * (p0_y - p2_y)) / div;\n  if (s < 0 || s > 1) return;\n\n  var t = (s2_x * (p2_y - p0_y) + s2_y * (p0_x - p2_x)) / div;\n\n  if (t >= 0 && t <= 1) {\n    return {\n      x: p0_x - (t * s1_x),\n      y: p0_y - (t * s1_y)\n    }\n  }\n}\n\nexport function same(x0, x1, y0, y1) {\n  return Math.abs(x0 - x1) < EPS && Math.abs(y0 - y1) < EPS;\n}\n\nexport function samePoint(a, b) {\n  return Math.abs(a.x - b.x) < EPS && Math.abs(a.y - b.y) < EPS;\n}\n","import SplayTree from 'splaytree';\nimport {samePoint, getIntersectionXPoint} from './geom'\n\n/**\n * Creates a new sweep status data structure.\n */\nexport default function createSweepStatus(onError, EPS) {\n  var lastPointY, prevY;\n  var lastPointX, prevX;\n  var useBelow = false;\n  var status = new SplayTree(compareSegments);\n\n  // To save on GC we return mutable object.\n  var currentBoundary = {\n    beforeLeft: null,\n    left: null,\n    right: null,\n    afterRight: null,\n  }\n\n  var currentLeftRight = {left: null, right: null};\n\n  return {\n    /**\n     * Add new segments into the status tree.\n     */\n    insertSegments,\n\n    /**\n     * Remove segments from the status tree.\n     */\n    deleteSegments,\n\n    /**\n     * Returns segments that are to the left and right from a given point.\n     */\n    getLeftRightPoint,\n\n    /**\n     * For a given collections of segments finds the most left and the most right\n     * segments. Also returns segments immediately before left, and after right segments.\n     */\n    getBoundarySegments,\n\n    findSegmentsWithPoint,\n\n    /**\n     * Current binary search tree with segments\n     */\n    status,\n\n    /**\n     * Introspection method that verifies if there are duplicates in the segment tree.\n     * If there are - `onError()` is called.\n     */\n    checkDuplicate,\n\n    /**\n     * Prints current segments in order of their intersection with sweep line. Introspection method.\n     */\n    printStatus,\n\n    /**\n     * Returns current position of the sweep line.\n     */\n    getLastPoint() {\n      return {x: lastPointX, y: lastPointY};\n    }\n  }\n\n  function compareSegments(a, b) {\n    if (a === b) return 0;\n\n    var ak = getIntersectionXPoint(a, lastPointX, lastPointY);\n    var bk = getIntersectionXPoint(b, lastPointX, lastPointY);\n\n    var res = ak - bk;\n    if (Math.abs(res) >= EPS) {\n      // We are okay fine. Intersection distance between two segments\n      // is good to give conclusive answer\n      return res;\n    }\n\n    var aIsHorizontal = Math.abs(a.dy) < EPS;\n    var bIsHorizontal = Math.abs(b.dy) < EPS;\n    if (aIsHorizontal && bIsHorizontal) {\n      return b.to.x - a.to.x;\n    }\n    // TODO: What if both a and b is horizontal?\n    // move horizontal to end\n    if (aIsHorizontal) { \n      return useBelow ? -1 : 1;\n    }\n\n    if (bIsHorizontal) {\n      if (useBelow) {\n        return (b.from.x >= lastPointX) ? -1 : 1\n      }\n      return -1;\n      // return useBelow ? 1 : -1;\n    }\n    var pa = a.angle;\n    var pb = b.angle;\n    if (Math.abs(pa - pb) >= EPS) {\n      return useBelow ? pa - pb : pb - pa;\n    }\n\n    var segDist = a.from.y - b.from.y;\n    if (Math.abs(segDist) >= EPS) {\n      return -segDist;\n    }\n    segDist = a.to.y - b.to.y;\n    if (Math.abs(segDist) >= EPS) {\n      // TODO: Is this accurate?\n      return -segDist;\n    }\n\n    return 0;\n    // Could also use:\n    // var aAngle = Math.atan2(a.from.y - a.to.y, a.from.x - a.to.x);\n    // var bAngle = Math.atan2(b.from.y - b.to.y, b.from.x - b.to.x);\n    // return useBelow ? bAngle - aAngle : aAngle - bAngle;\n  }\n\n  function getBoundarySegments(upper, interior) {\n    var leftMost, rightMost, i;\n    var uLength = upper.length;\n\n    if (uLength > 0) {\n      leftMost = rightMost = upper[0];\n    } else {\n      leftMost = rightMost = interior[0];\n    }\n\n    for (i = 1; i < uLength; ++i) {\n      var s = upper[i];\n      var cmp = compareSegments(leftMost, s);\n      if (cmp > 0) leftMost = s;\n\n      cmp = compareSegments(rightMost, s);\n      if (cmp < 0) rightMost = s;\n    }\n\n    var startFrom = uLength > 0 ? 0 : 1;\n    for (i = startFrom; i < interior.length; ++i) {\n      s = interior[i];\n      cmp = compareSegments(leftMost, s);\n      if (cmp > 0) leftMost = s;\n\n      cmp = compareSegments(rightMost, s);\n      if (cmp < 0) rightMost = s;\n    }\n\n    // at this point we have our left/right segments in the status.\n    // Let's find their prev/next elements and report them back:\n    var left = status.find(leftMost);\n    if (!left) {\n      onError('Left is missing. Precision error?');\n    }\n\n    var right = status.find(rightMost);\n    if (!right) {\n      onError('Right is missing. Precision error?');\n    }\n\n    var beforeLeft = left && status.prev(left);\n    var afterRight = right && status.next(right);\n\n    while (afterRight && right.key.dy === 0 && afterRight.key.dy === 0) {\n      // horizontal segments are special :(\n      afterRight = status.next(afterRight);\n    }\n\n    currentBoundary.beforeLeft = beforeLeft && beforeLeft.key;\n    currentBoundary.left = left && left.key;\n    currentBoundary.right = right && right.key;\n    currentBoundary.afterRight = afterRight && afterRight.key;\n\n    return currentBoundary;\n  }\n\n  function getLeftRightPoint(p) {\n    // We are trying to find left and right segments that are nearest to the\n    // point p. For this we traverse the binary search tree, and remember\n    // node with the shortest distance to p.\n    var lastLeft;\n    var current = status._root;\n    var minX = Number.POSITIVE_INFINITY;\n\n    var useNext = false;\n    while (current) {\n      var x = getIntersectionXPoint(current.key, p.x, p.y);\n      var dx = p.x - x;\n      if (dx >= 0) {\n        if (dx < minX) {\n          minX = dx;\n          lastLeft = current;\n          current = current.left;\n          useNext = false;\n        } else {\n          break;\n        }\n      } else {\n        if (-dx < minX) {\n          useNext = true;\n          minX = -dx;\n          lastLeft = current;\n          current = current.right;\n        } else {\n          break;\n        }\n      }\n    }\n    if (useNext) {\n      // I'm not sure why I did this. I don't this this is right now.\n      // lastLeft = status.next(lastLeft);\n    }\n\n    currentLeftRight.left = lastLeft && lastLeft.key\n    var next = lastLeft && status.next(lastLeft);\n    currentLeftRight.right = next && next.key\n    return currentLeftRight;\n\n    // Conceptually, the code above should be equivalent to the code below;\n    // The code below is easier to understand, but intuitively, the code above\n    // should have better performance (as we do not traverse the entire status\n    // tree)\n\n    // var right, left,  x;\n    // var all = status.keys()\n    // for (var i = 0; i < all.length; ++i) {\n    //   var segment = all[i];\n    //   x = getIntersectionXPoint(segment, p.x, p.y);\n    //   if (x > p.x && !right) {\n    //     right = segment;\n    //     break;\n    //   } else if (x < p.x) {\n    //     left = segment;\n    //   }\n    // }\n\n    // currentLeftRight.left = left;\n    // currentLeftRight.right = right;\n\n    // return currentLeftRight;\n  }\n\n  function findSegmentsWithPoint(p, onFound) {\n    // Option 1.\n    // var arrResults = [];\n    // status.forEach(current => {\n    //   var x = getIntersectionXPoint(current.key, p.x, p.y);\n    //   var dx = p.x - x;\n    //   if (Math.abs(dx) < EPS) {\n    //     onFound(current.key);\n    //    // arrResults.push(current.key)\n    //   }\n    // });\n    // return arrResults;\n\n    // Option 2.\n\n    // let current = status._root;\n    // const Q = [];  /* Initialize stack s */\n    // let done = false;\n    // var res = [];\n    // var breakEarly = false;\n\n    // while (!done) {\n    //   if (current !==  null) {\n    //     Q.push(current);\n    //     current = current.left;\n    //   } else {\n    //     if (Q.length !== 0) {\n    //       current = Q.pop();\n\n    //       var x = getIntersectionXPoint(current.key, p.x, p.y);\n    //       var dx = p.x - x;\n    //       if (Math.abs(dx) < EPS) {\n    //         res.push(current.key)\n    //         breakEarly = true;\n    //       } else if (breakEarly) {\n    //         done = true;\n    //       }\n\n    //       current = current.right;\n    //     } else done = true;\n    //   }\n    // }\n\n    // return res;\n\n    // option 3.\n    var current = status._root;\n\n    while (current) {\n      var x = getIntersectionXPoint(current.key, p.x, p.y);\n      var dx = p.x - x;\n      if (Math.abs(dx) < EPS) {\n        collectAdjacentNodes(current, p, onFound);\n        break;\n      } else if (dx < 0) {\n        current = current.left;\n      } else {\n        current = current.right;\n      }\n    }\n  }\n\n  function collectAdjacentNodes(root, p, onFound) {\n    onFound(root.key);\n    goOverPredecessors(root.left, p, onFound);\n    goOverSuccessors(root.right, p, onFound);\n  }\n\n  function goOverPredecessors(root, p, res) {\n    if (!root) return;\n    var x = getIntersectionXPoint(root.key, p.x, p.y);\n    var dx = p.x - x;\n    if (Math.abs(dx) < EPS) {\n      collectAdjacentNodes(root, p, res);\n    } else {\n      goOverPredecessors(root.right, p, res);\n    }\n  }\n\n  function goOverSuccessors(root, p, res) {\n    if (!root) return;\n    var x = getIntersectionXPoint(root.key, p.x, p.y);\n    var dx = p.x - x;\n    if (Math.abs(dx) < EPS) {\n      collectAdjacentNodes(root, p, res);\n    } else {\n      goOverSuccessors(root.left, p, res);\n    }\n  }\n\n  function checkDuplicate() {\n    var prev;\n    status.forEach(node => {\n      var current = node.key;\n\n      if (prev) {\n        if (samePoint(prev.from, current.from) && samePoint(prev.to, current.to)) {\n          // Likely you have received error before during segment removal.\n          onError('Duplicate key in the status! This may be caused by Floating Point rounding error')\n        }\n      }\n      prev = current;\n    });\n  }\n\n  function printStatus(prefix = '') {\n    // eslint-disable-next-line\n    console.log(prefix, 'status line: ', lastPointX, lastPointY);\n    status.forEach(node => {\n      var x = getIntersectionXPoint(node.key, lastPointX, lastPointY);\n      // eslint-disable-next-line\n      console.log(x + ' ' + node.key.name);\n    })\n  }\n\n  function insertSegments(interior, upper, sweepLinePos) {\n    lastPointY = sweepLinePos.y;\n    lastPointX = sweepLinePos.x;\n    var key;\n\n    for (var i = 0; i < interior.length; ++i) {\n      key = interior[i];\n      status.add(key);\n    }\n    for (i = 0; i < upper.length; ++i) {\n      key = upper[i]\n      status.add(key);\n    }\n  }\n\n  function deleteSegments(lower, interior, sweepLinePos) {\n    // I spent most of the time debugging this method. Depending on the\n    // algorithm state we can run into situation when dynamic keys of the\n    // `status` tree predict wrong branch, and thus we are not able to find\n    // the segment that needs to be deleted. If that happens I'm trying to\n    // use previous point and repeat the process. This may result in \n    // incorrect state. In that case I report an error. \n    var i;\n    var prevCount = status._size;\n    prevX = lastPointX;\n    prevY = lastPointY;\n    lastPointY = sweepLinePos.y;\n    lastPointX = sweepLinePos.x;\n\n    useBelow = true;\n    for(i = 0; i < lower.length; ++i) {\n      removeSegment(lower[i], sweepLinePos)\n    }\n    for(i = 0; i < interior.length; ++i) {\n      removeSegment(interior[i], sweepLinePos)\n    }\n    useBelow = false;\n\n    if (status._size !== prevCount - interior.length - lower.length) {\n      // This can happen when rounding error occurs. You can try scaling your input\n      onError('Segments were not removed from a tree properly. Precision error?');\n    }\n  }\n\n  function removeSegment(key, sweepLinePos) {\n    if (status.find(key)) {\n      status.remove(key);\n    } else {\n      lastPointX = prevX;\n      lastPointY = prevY;\n      if (status.find(key)) {\n        status.remove(key);\n      } else {\n        // They will get an error :(\n      }\n      lastPointY = sweepLinePos.y;\n      lastPointX = sweepLinePos.x;\n    }\n  }\n}","/**\n * Represents a single event in the sweep-line algorithm\n */\nexport default class SweepEvent {\n  /**\n   * Creates new sweep event of a given kind.\n   */\n  constructor(point, segment) {\n    this.point = point;\n    if (segment) this.from = [segment];\n  }\n}\n","import createEventQueue from './src/createEventQueue';\nimport createSweepStatus from './src/sweepStatus';\nimport SweepEvent from './src/SweepEvent';\n\nimport {intersectSegments, EPS, angle, samePoint} from './src/geom';\n\n/**\n * A point on a line\n * \n * @typedef {Object} Point\n * @property {number} x coordinate\n * @property {number} y coordinate\n */\n\n\n/**\n * @typedef {Object} Segment \n * @property {Point} from start of the segment\n * @property {Point} to end of the segment\n */\n\n/**\n * @typedef {function(point : Point, interior : Segment[], lower : Segment[], upper : Segment[])} ReportIntersectionCallback\n */\n\n/**\n * @typedef {Object} ISectOptions \n * @property {ReportIntersectionCallback} onFound \n */\n\n /**\n  * @typedef {Object} ISectResult\n  */\n\n// We use EMPTY array to avoid pressure on garbage collector. Need to be\n// very cautious to not mutate this array.\nvar EMPTY = [];\n\n/**\n * Finds all intersections among given segments.\n * \n * The algorithm follows \"Computation Geometry, Algorithms and Applications\" book\n * by Mark de Berg, Otfried Cheong, Marc van Kreveld, and Mark Overmars.\n * \n * Line is swept top-down\n * \n * @param {Segment[]} segments\n * @param {ISectOptions=} options\n * @returns {ISectResult}\n */\nexport default function isect(segments, options) {\n  var results = [];\n  var reportIntersection = (options && options.onFound) || defaultIntersectionReporter;\n\n  var onError = (options && options.onError) || defaultErrorReporter;\n\n  var eventQueue = createEventQueue(byY);\n  var sweepStatus = createSweepStatus(onError, EPS);\n  var lower, interior, lastPoint;\n\n  segments.forEach(addSegment);\n\n  return {\n    /**\n     * Find all intersections synchronously.\n     * \n     * @returns array of found intersections.\n     */\n    run,\n\n    /**\n     * Performs a single step in the sweep line algorithm\n     * \n     * @returns true if there was something to process; False if no more work to do\n     */\n    step,\n\n    // Methods below are low level API for fine-grained control.\n    // Don't use it unless you understand this code thoroughly\n\n    /**\n     * Add segment into the \n     */\n    addSegment,\n\n    /**\n     * Direct access to event queue. Queue contains segment endpoints and\n     * pending detected intersections.\n     */\n    eventQueue, \n\n    /**\n     * Direct access to sweep line status. \"Status\" holds information about\n     * all intersected segments.\n     */\n    sweepStatus,\n\n    /**\n     * Access to results array. Works only when you use default onFound() handler\n     */\n    results\n  }\n\n  function run() {\n    while (!eventQueue.isEmpty()) {\n      var eventPoint = eventQueue.pop();\n      if (handleEventPoint(eventPoint)) {\n        // they decided to stop.\n        return;\n      };\n    }\n\n    return results;\n  }\n\n  function step() {\n    if (!eventQueue.isEmpty()) {\n      var eventPoint = eventQueue.pop();\n      handleEventPoint(eventPoint);\n      // Note: we don't check results of `handleEventPoint()`\n      // assumption is that client controls `step()` and thus they \n      // know better if they want to stop.\n      return true;\n    }\n    return false;\n  }\n\n  function handleEventPoint(p) {\n    lastPoint = p.point;\n    var upper = p.from || EMPTY;\n\n    lower = interior = undefined;\n    // TODO: move lower/interior into sweep status method?\n\n    sweepStatus.findSegmentsWithPoint(lastPoint, addLowerOrInterior);\n    // if (segmentsWithPoint) {\n    //   segmentsWithPoint.forEach()\n    // } \n\n    if (!lower) lower = EMPTY;\n    if (!interior) interior = EMPTY;\n\n    var uLength = upper.length;\n    var iLength = interior.length;\n    var lLength = lower.length;\n    var hasIntersection = uLength + iLength + lLength > 1;\n    var hasPointIntersection = !hasIntersection && (uLength === 0 && lLength === 0 && iLength > 0);\n\n    if (hasIntersection || hasPointIntersection) {\n      p.isReported = true;\n      if (reportIntersection(lastPoint, union(interior, union(lower, upper)))) {\n        return true;\n      }\n    }\n\n    sweepStatus.deleteSegments(lower, interior, lastPoint);\n    sweepStatus.insertSegments(interior, upper, lastPoint);\n\n    var sLeft, sRight;\n\n    var hasNoCrossing = (uLength + iLength === 0);\n\n    if (hasNoCrossing) {\n      var leftRight = sweepStatus.getLeftRightPoint(lastPoint);\n      sLeft = leftRight.left;\n      if (!sLeft) return;\n\n      sRight = leftRight.right;\n      if (!sRight) return;\n\n      findNewEvent(sLeft, sRight, p);\n    } else {\n      var boundarySegments = sweepStatus.getBoundarySegments(upper, interior);\n\n      findNewEvent(boundarySegments.beforeLeft, boundarySegments.left, p);\n      findNewEvent(boundarySegments.right, boundarySegments.afterRight, p);\n    }\n\n    return false;\n  }\n\n  function addLowerOrInterior(s) {\n    if (samePoint(s.to, lastPoint)) {\n      if (!lower) lower = [s];\n      else lower.push(s);\n    } else if (!samePoint(s.from, lastPoint)) {\n      if (!interior) interior = [s];\n      else interior.push(s);\n    }\n  }\n\n  function findNewEvent(left, right, p) {\n    if (!left || !right) return;\n\n    var intersection = intersectSegments(left, right);\n    if (!intersection) {\n        return;\n    }\n\n    var dy = p.point.y - intersection.y\n    // TODO: should I add dy to intersection.y?\n    if (dy < -EPS) {\n      // this means intersection happened after the sweep line. \n      // We already processed it.\n      return;\n    }\n    if (Math.abs(dy) < EPS && intersection.x <= p.point.x) {\n      return;\n    }\n\n    // Need to adjust floating point for this special case,\n    // since otherwise it gives rounding errors:\n    roundNearZero(intersection);\n\n    var current = eventQueue.find(intersection);\n\n    if (current && current.isReported) {\n      // We already reported this event. No need to add it one more time\n      // TODO: Is this case even possible?\n      onError('We already reported this event.');\n      return;\n    }\n\n    if (!current) {\n      var event = new SweepEvent(intersection)\n      eventQueue.insert(event);\n    }\n  }\n\n  function defaultIntersectionReporter(p, segments) {\n    results.push({\n      point: p, \n      segments: segments\n    });\n  }\n\n  function addSegment(segment) {\n    var from = segment.from;\n    var to = segment.to;\n\n    // Small numbers give more precision errors. Rounding them to 0.\n    roundNearZero(from);\n    roundNearZero(to);\n\n    var dy = from.y - to.y;\n\n    // Note: dy is much smaller then EPS on purpose. I found that higher\n    // precision here does less good - getting way more rounding errors.\n    if (Math.abs(dy) < 1e-5) {\n      from.y = to.y;\n      segment.dy = 0;\n    }\n    if ((from.y < to.y) || (\n        (from.y === to.y) && (from.x > to.x))\n      ) {\n      var temp = from;\n      from = segment.from = to; \n      to = segment.to = temp;\n    }\n\n    // We pre-compute some immutable properties of the segment\n    // They are used quite often in the tree traversal, and pre-computation\n    // gives significant boost:\n    segment.dy = from.y - to.y;\n    segment.dx = from.x - to.x;\n    segment.angle = angle(segment.dy, segment.dx);\n\n    var isPoint = segment.dy === segment.dx && segment.dy === 0;\n    var prev = eventQueue.find(from)\n    if (prev && !isPoint) {\n      // this detects identical segments early. Without this check\n      // the algorithm would break since sweep line has no means to\n      // detect identical segments.\n      var prevFrom = prev.data.from;\n      if (prevFrom) {\n        for (var i = 0; i < prevFrom.length; ++i) {\n          var s = prevFrom[i];\n          if (samePoint(s.to, to)) {\n            reportIntersection(s.from, [s.from, s.to]);\n            reportIntersection(s.to, [s.from, s.to]);\n            return;\n          }\n        }\n      }\n    }\n\n    if (!isPoint) {\n      if (prev) {\n        if (prev.data.from) prev.data.from.push(segment);\n        else prev.data.from = [segment];\n      } else {\n        var e = new SweepEvent(from, segment)\n        eventQueue.insert(e);\n      }\n      var event = new SweepEvent(to)\n      eventQueue.insert(event)\n    } else {\n      var event = new SweepEvent(to)\n      eventQueue.insert(event)\n    }\n  } \n}\n\nfunction roundNearZero(point) {\n  if (Math.abs(point.x) < EPS) point.x = 0;\n  if (Math.abs(point.y) < EPS) point.y = 0;\n}\n\nfunction defaultErrorReporter(errorMessage) {\n  throw new Error(errorMessage);\n}\n\nfunction union(a, b) {\n  if (!a) return b;\n  if (!b) return a;\n\n  return a.concat(b);\n}\n\nfunction byY(a, b) {\n  // decreasing Y \n  var res = b.y - a.y;\n  // TODO: This might mess up the status tree.\n  if (Math.abs(res) < EPS) {\n    // increasing x.\n    res = a.x - b.x;\n    if (Math.abs(res) < EPS) res = 0;\n  }\n\n  return res;\n}","export default function intersectSegments(a, b) {\n  // Note: this is almost the same as geom.intersectSegments()\n  // The main difference is that we don't have a pre-computed\n  // value for dx/dy on the segments.\n  //  https://stackoverflow.com/a/1968345/125351\n  var aStart = a.from, bStart = b.from;\n  var p0_x = aStart.x, p0_y = aStart.y,\n      p2_x = bStart.x, p2_y = bStart.y;\n\n  var s1_x = a.from.x - a.to.x, s1_y = a.from.y - a.to.y, s2_x = b.from.x - b.to.x, s2_y = b.from.y - b.to.y;\n  var div = s1_x * s2_y - s2_x * s1_y;\n\n  var s = (s1_y * (p0_x - p2_x) - s1_x * (p0_y - p2_y)) / div;\n  if (s < 0 || s > 1) return;\n\n  var t = (s2_x * (p2_y - p0_y) + s2_y * (p0_x - p2_x)) / div;\n\n  if (t >= 0 && t <= 1) {\n    return {\n      x: p0_x - (t * s1_x),\n      y: p0_y - (t * s1_y)\n    }\n  }\n}","import intersectSegments from './src/intersectSegments';\n\n/**\n * This is a brute force solution with O(n^2) performance.\n * (`n` is number of segments).\n * \n * Use this when number of lines is low, and number of intersections\n * is high.\n */\nexport default function brute(lines, options) {\n  var results = [];\n  var reportIntersection = (options && options.onFound) || \n                            defaultIntersectionReporter;\n  var asyncState;\n\n  return {\n    /**\n     * Execute brute force of the segment intersection search\n     */\n    run,\n    /**\n     * Access to results array. Works only when you use default onFound() handler\n     */\n    results,\n\n    /**\n     * Performs a single step in the brute force algorithm ()\n     */\n    step\n  }\n\n  function step() {\n    if (!asyncState) {\n      asyncState = {\n        i: 0\n      }\n    }\n    var test = lines[asyncState.i];\n    for (var j = asyncState.i + 1; j < lines.length; ++j) {\n      var other = lines[j];\n      var pt = intersectSegments(test, other);\n      if (pt) {\n        if (reportIntersection(pt, [test, other])) {\n          return;\n        }\n      }\n    }\n    asyncState.i += 1;\n    return asyncState.i < lines.length;\n  }\n\n  function run() {\n    for(var i = 0; i < lines.length; ++i) {\n      var test = lines[i];\n      for (var j = i + 1; j < lines.length; ++j) {\n        var other = lines[j];\n        var pt = intersectSegments(test, other);\n        if (pt) {\n          if (reportIntersection(pt, [test, other])) {\n            return;\n          }\n        }\n      }\n    }\n    return results;\n  }\n\n  function defaultIntersectionReporter(p, interior) {\n    results.push({\n      point: p, \n      segments: interior\n    });\n  }\n}","import Flatbush from 'flatbush';\nimport intersectSegments from './src/intersectSegments';\n\n/**\n * This implementation is inspired by discussion here \n * https://twitter.com/mourner/status/1049325199617921024 and \n * here https://github.com/anvaka/isect/issues/1\n * \n * It builds an index of all segments using static spatial index\n * and then for each segment it queries overlapping rectangles.\n */\nexport default function bush(lines, options) {\n  var results = [];\n  var reportIntersection = (options && options.onFound) || \n                            defaultIntersectionReporter;\n  var asyncState;\n\n  var index = new Flatbush(lines.length);\n  lines.forEach(addToIndex);\n  index.finish();\n\n  return {\n    run: run,\n    step: step,\n    results: results,\n\n    // undocumented, don't use unless you know what you are doing:\n    checkIntersection: checkIntersection\n  }\n\n  function run() {\n    for (var i = 0; i < lines.length; ++i) {\n      if (checkIntersection(lines[i], i)) {\n        return; // stop early\n      }\n    }\n    return results;\n  }\n\n  function checkIntersection(currentSegment, currentId) {\n    // sorry about code duplication.\n    var minX = currentSegment.from.x; var maxX = currentSegment.to.x;\n    var minY = currentSegment.from.y; var maxY = currentSegment.to.y;\n    var t;\n    if (minX > maxX) { t = minX; minX = maxX; maxX = t; }\n    if (minY > maxY) { t = minY; minY = maxY; maxY = t; }\n\n    var ids = index.search(minX, minY, maxX, maxY);\n\n    for (var i = 0; i < ids.length; ++i) {\n      var segmentIndex = ids[i];\n      if (segmentIndex <= currentId) continue; // we have either reported it, or it is current.\n\n      var otherSegment = lines[segmentIndex];\n      var point = intersectSegments(otherSegment, currentSegment);\n\n      if (point) {\n        if (reportIntersection(point, [currentSegment, otherSegment])) {\n          // stop early\n          return true;\n        }\n      }\n    }\n  }\n\n  function step() {\n    if (!asyncState) {\n      asyncState = {i: 0};\n    }\n    var test = lines[asyncState.i];\n    checkIntersection(test, asyncState.i);\n    asyncState.i += 1;\n    return asyncState.i < lines.length;\n  }\n\n\n  function addToIndex(line) {\n    var minX = line.from.x; var maxX = line.to.x;\n    var minY = line.from.y; var maxY = line.to.y;\n    var t;\n    if (minX > maxX) { t = minX; minX = maxX; maxX = t; }\n    if (minY > maxY) { t = minY; minY = maxY; maxY = t; }\n    index.add(minX, minY, maxX, maxY);\n  }\n\n  function defaultIntersectionReporter(p, interior) {\n    results.push({\n      point: p, \n      segments: interior\n    });\n  }\n}","import sweep from './sweep';\nimport brute from './brute';\nimport bush from './bush';\n\nexport {\n  sweep, brute, bush\n}"],"sourceRoot":""}